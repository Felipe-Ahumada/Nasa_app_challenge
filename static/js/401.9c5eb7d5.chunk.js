"use strict";(self.webpackChunkzuricatas_simulator_frontend=self.webpackChunkzuricatas_simulator_frontend||[]).push([[401],{401:(e,t,s)=>{s.r(t),s.d(t,{default:()=>f});var i=s(379),a=s(43),o=s(918),r=s(985),n=s(309),l=s(7),c=s(201),m=s(408),h=s(579);const p=a.memo(e=>{let{impactLocation:t,showImpact:s=!1,animationPhase:i="idle",impactProgress:r=0,materialSettings:n={}}=e;const l=(0,a.useRef)(),p=(0,a.useRef)(),d=(0,a.useRef)(),x=(0,a.useRef)(),[u,f,g]=(0,c.z)(["https://threejs.org/examples/textures/planets/earth_atmos_2048.jpg","https://threejs.org/examples/textures/planets/earth_normal_2048.jpg","https://threejs.org/examples/textures/planets/earth_clouds_1024.png"]),j=(0,a.useMemo)(()=>new m.MeshStandardMaterial({map:u,normalMap:f,roughness:.85,metalness:0}),[u,f]),y=(0,a.useMemo)(()=>new m.MeshBasicMaterial({color:"#87CEEB",transparent:!0,opacity:.1,side:m.BackSide}),[]),M=(0,a.useMemo)(()=>{if(!t)return[0,0,2.1];const e=t.lat*Math.PI/180,s=t.lng*Math.PI/180,i=2.05;return[i*Math.cos(e)*Math.cos(s),i*Math.sin(e),i*Math.cos(e)*Math.sin(s)]},[t]),b=(0,a.useMemo)(()=>{const e=new m.Vector3(...M).normalize(),t=new m.Quaternion;return t.setFromUnitVectors(new m.Vector3(0,0,1),e),t},[M]);return(0,o.C)(e=>{if(l.current&&(l.current.rotation.y+=.005),p.current&&(p.current.rotation.y+=.003),x.current&&(x.current.rotation.y+=.006),d.current&&("impact"===i||"explosion"===i)){const t=1+.3*Math.sin(10*e.clock.elapsedTime);d.current.scale.setScalar(t)}}),(0,h.jsxs)("group",{children:[(0,h.jsx)("mesh",{ref:l,material:j,children:(0,h.jsx)("sphereGeometry",{args:[2,64,32]})}),(0,h.jsxs)("mesh",{ref:x,children:[(0,h.jsx)("sphereGeometry",{args:[2.03,64,32]}),(0,h.jsx)("meshPhongMaterial",{map:g,transparent:!0,opacity:.4,depthWrite:!1})]}),(0,h.jsx)("mesh",{ref:p,material:y,children:(0,h.jsx)("sphereGeometry",{args:[2.1,32,16]})}),t&&(0,h.jsxs)("mesh",{ref:d,position:M,children:[(0,h.jsx)("sphereGeometry",{args:[.05,8,8]}),(0,h.jsx)("meshBasicMaterial",{color:s?"#ff4444":"#ffff44",transparent:!0,opacity:.8})]}),t&&("impact"===i||"explosion"===i||"aftermath"===i)&&(0,h.jsxs)("group",{position:M,children:[(0,h.jsx)("primitive",{object:new m.AxesHelper(0),visible:!1}),(0,h.jsxs)("group",{quaternion:b,children:[(0,h.jsxs)("mesh",{position:[0,0,-.02],children:[(0,h.jsx)("cylinderGeometry",{args:[0,.22,.06,24]}),(0,h.jsx)("meshStandardMaterial",{color:"#6b3e2e",roughness:1,metalness:0})]}),("impact"===i||"explosion"===i)&&(0,h.jsxs)("mesh",{children:[(0,h.jsx)("ringGeometry",{args:[.25+.8*r,.27+.85*r,64]}),(0,h.jsx)("meshBasicMaterial",{color:"#ffaa00",transparent:!0,opacity:.6-.5*r,side:m.DoubleSide})]}),("explosion"===i||"aftermath"===i)&&(0,h.jsxs)("mesh",{children:[(0,h.jsx)("ringGeometry",{args:[.3+1.2*r,.34+1.22*r,96]}),(0,h.jsx)("meshBasicMaterial",{color:"#1e90ff",transparent:!0,opacity:.35-.3*Math.max(0,r-.3),side:m.DoubleSide})]})]})]})]})}),d=a.memo(e=>{var t,s;let{asteroidData:i,position:r=[0,0,5],animationPhase:n="idle",animationProgress:l=0}=e;const c=(0,a.useRef)(),p=(0,a.useRef)(),d=(null===i||void 0===i||null===(t=i.estimatedDiameter)||void 0===t||null===(s=t.kilometers)||void 0===s?void 0:s.estimated_diameter_max)||.1,x=Math.max(.05,Math.min(.1*d,.5)),u=(0,a.useMemo)(()=>new m.MeshStandardMaterial({color:"#8B4513",roughness:.8,metalness:.1,bumpScale:.05}),[]),f=(0,a.useMemo)(()=>new m.MeshBasicMaterial({color:"#ff6600",transparent:!0,opacity:.6}),[]);return(0,o.C)(e=>{if(c.current&&(c.current.rotation.x+=.02,c.current.rotation.y+=.01,"approaching"===n&&u)){const e=2*l;u.emissive.setRGB(.5*e,.2*e,0)}}),(0,h.jsxs)("group",{position:r,children:[(0,h.jsx)("mesh",{ref:c,material:u,children:(0,h.jsx)("sphereGeometry",{args:[x,16,8]})}),"approaching"===n&&(0,h.jsxs)("mesh",{ref:p,position:[0,0,2*x],children:[(0,h.jsx)("coneGeometry",{args:[.3*x,3*x,8]}),(0,h.jsx)("primitive",{object:f})]})]})}),x=e=>{let{position:t=[0,0,2],animationPhase:s="idle",animationProgress:i=0}=e;const o=(0,a.useRef)(),r=((0,a.useRef)(),(0,a.useMemo)(()=>"impact"===s?2*i:"explosion"===s?1+i:0,[s,i])),n=(0,a.useMemo)(()=>{const e=[];for(let t=0;t<20;t++){const s=t/20*Math.PI*2,i=.3+.7*Math.random();e.push({position:[Math.cos(s)*i,.5*Math.random(),Math.sin(s)*i],scale:.02+.03*Math.random()})}return e},[]);return(0,h.jsxs)("group",{position:t,children:[r>0&&(0,h.jsxs)("mesh",{ref:o,scale:r,children:[(0,h.jsx)("sphereGeometry",{args:[.3,16,8]}),(0,h.jsx)("meshBasicMaterial",{color:"#ff8800",transparent:!0,opacity:.7-.5*i})]}),"explosion"===s&&n.map((e,t)=>(0,h.jsxs)("mesh",{position:e.position.map(e=>e*i),scale:e.scale,children:[(0,h.jsx)("sphereGeometry",{args:[1,4,4]}),(0,h.jsx)("meshBasicMaterial",{color:"#8B4513"})]},t))]})},u=e=>{let{simulationData:t,onAnimationComplete:s}=e;const{impactData:i,asteroidData:r,impactLocation:l,impactAngle:c=45,impactVelocity:u=20,animate:f=!1}=t||{},{phase:g,progress:j,asteroidPosition:y}=((e,t,s)=>{const[i,o]=(0,a.useState)("idle"),[r,n]=(0,a.useState)(0),[l,c]=(0,a.useState)([0,0,8]),h=(0,a.useMemo)(()=>{if(!s)return new m.Vector3(0,0,2);const e=s.lat*Math.PI/180,t=s.lng*Math.PI/180,i=2.05,a=i*Math.cos(e)*Math.cos(t),o=i*Math.sin(e),r=i*Math.cos(e)*Math.sin(t);return new m.Vector3(a,o,r)},[s]),p=(0,a.useMemo)(()=>h.clone().normalize().multiplyScalar(8),[h]);return(0,a.useEffect)(()=>{if(!e)return o("idle"),n(0),void c([0,0,8]);let s,i=Date.now();const a=()=>{const e=Date.now()-i,r=Math.min(e/9e3,1);if(n(r),r<.45){o("approaching");const e=r/.45,t=e*e,s=(new m.Vector3).lerpVectors(p,h,t);c([s.x,s.y,s.z+0])}else if(r<.55)o("impact"),c([h.x,h.y,h.z]);else if(r<.85)o("explosion"),c([h.x,h.y,h.z]);else{if(!(r<1))return o("complete"),void(t&&t());o("aftermath"),c([h.x,h.y,h.z])}s=requestAnimationFrame(a)};return s=requestAnimationFrame(a),()=>{s&&cancelAnimationFrame(s)}},[e,t]),{phase:i,progress:r,asteroidPosition:l}})(f,s,l),{camera:M}=(0,o.A)();return(0,o.C)(()=>{"approaching"===g?(M.position.lerp(new m.Vector3(5,3,5),.02),M.lookAt(0,0,0)):"impact"!==g&&"explosion"!==g||(M.position.lerp(new m.Vector3(3,2,3),.02),M.lookAt(0,0,2))}),(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)("ambientLight",{intensity:.3,color:"#ffffff"}),(0,h.jsx)("directionalLight",{position:[10,10,5],intensity:1,castShadow:!0,"shadow-mapSize-width":2048,"shadow-mapSize-height":2048,"shadow-camera-far":50,"shadow-camera-left":-10,"shadow-camera-right":10,"shadow-camera-top":10,"shadow-camera-bottom":-10}),("impact"===g||"explosion"===g)&&(0,h.jsx)("pointLight",{position:y,intensity:2,color:"#ff8800",distance:10}),(0,h.jsx)(p,{impactLocation:l,showImpact:"idle"!==g&&"approaching"!==g,animationPhase:g,impactProgress:j}),r&&"complete"!==g&&(0,h.jsx)(d,{asteroidData:r,position:y,animationPhase:g,animationProgress:j}),("impact"===g||"explosion"===g||"aftermath"===g)&&(0,h.jsx)(x,{position:y,animationPhase:g,animationProgress:j}),(0,h.jsx)(n.E,{position:[0,4,0],children:(0,h.jsxs)("div",{style:{background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"10px 15px",borderRadius:"8px",fontSize:"14px",textAlign:"center",fontFamily:"Arial, sans-serif",border:"1px solid #333"},children:[(0,h.jsx)("div",{style:{fontWeight:"bold",marginBottom:"5px"},children:"Enhanced Impact Simulation"}),(0,h.jsxs)("div",{children:["Phase: ",(0,h.jsx)("span",{style:{color:"#ff6b35"},children:g})]}),(0,h.jsxs)("div",{children:["Progress: ",(0,h.jsxs)("span",{style:{color:"#ff6b35"},children:[(100*j).toFixed(1),"%"]})]}),r&&(0,h.jsxs)("div",{children:["Asteroid: ",(0,h.jsx)("span",{style:{color:"#ff6b35"},children:r.name||"Test Asteroid"})]}),l&&(0,h.jsx)("div",{children:(()=>{const e=Number(l.lat),t=Number(l.lng),s=Number.isFinite(e)?e.toFixed(2):"N/A",i=Number.isFinite(t)?t.toFixed(2):"N/A";return(0,h.jsxs)(h.Fragment,{children:["Location: ",(0,h.jsxs)("span",{style:{color:"#ff6b35"},children:[s,"\xb0, ",i,"\xb0"]})]})})()})]})})]})},f=e=>{let{simulationData:t={},onAnimationComplete:s,style:o={}}=e;const[n,c]=(0,a.useState)(!0),[m]=(0,a.useState)(null);return(0,a.useEffect)(()=>{const e=setTimeout(()=>{c(!1)},1e3);return()=>clearTimeout(e)},[]),m?(0,h.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#000",color:"#fff",fontSize:"16px"},children:(0,h.jsxs)("div",{children:[(0,h.jsx)("div",{style:{marginBottom:"10px",color:"#ff4444"},children:"\u26a0\ufe0f Error"}),(0,h.jsx)("div",{children:m})]})}):n?(0,h.jsx)("div",{style:{height:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:"#000",color:"#fff",fontSize:"16px"},children:(0,h.jsxs)("div",{style:{textAlign:"center"},children:[(0,h.jsx)("div",{style:{marginBottom:"10px",fontSize:"24px"},children:"\ud83d\ude80"}),(0,h.jsx)("div",{children:"Loading Enhanced 3D..."}),(0,h.jsx)("div",{style:{fontSize:"12px",color:"#888",marginTop:"5px"},children:"Initializing physics engine and shaders"})]})}):(0,h.jsxs)("div",{style:(0,i.A)({height:"100%",width:"100%",position:"relative"},o),children:[(0,h.jsxs)(r.Hl,{camera:{position:[5,3,5],fov:60},style:{background:"linear-gradient(to bottom, #000011 0%, #000033 100%)"},shadows:!0,gl:{antialias:!0,alpha:!1},children:[(0,h.jsx)(l.N,{enablePan:!0,enableZoom:!0,enableRotate:!0,maxDistance:20,minDistance:2,enableDamping:!0,dampingFactor:.05}),(0,h.jsx)(u,{simulationData:t,onAnimationComplete:s})]}),(0,h.jsx)("div",{style:{position:"absolute",bottom:"10px",right:"10px",background:"rgba(0, 0, 0, 0.7)",color:"#ff6b35",padding:"5px 10px",borderRadius:"4px",fontSize:"12px",fontFamily:"monospace"},children:"Enhanced Mode: Active"})]})}}}]);
//# sourceMappingURL=401.9c5eb7d5.chunk.js.map